- name: Configure Web Server
  hosts: localhost
  connection: local
  become: yes

  tasks:
    # --- FIX STARTS HERE ---
    # We use 'shell' because standard 'yum' cannot find Nginx on Amazon Linux 2
    - name: Install Nginx (Amazon Linux Extras)
      shell: "amazon-linux-extras install nginx1 -y"
    
    # We removed the standard 'yum' task because it causes the error
    # --- FIX ENDS HERE ---

    - name: Start Nginx Service
      service:
        name: nginx
        state: started
        enabled: yes

    - name: Create Stylish Hello World Page
      copy:
        dest: /usr/share/nginx/html/index.html
        content: |
          <!DOCTYPE html>
          <html>
          <head>
            <title>Welcome</title>
            <style>
              body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                height: 100vh;
                margin: 0;
                display: flex;
                align-items: center;
                justify-content: center;
              }
              .card {
                background: white;
                padding: 40px;
                border-radius: 12px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                text-align: center;
                max-width: 500px;
              }
              h1 {
                color: #2d3748;
                margin-bottom: 10px;
                font-size: 28px;
              }
              .subtitle {
                color: #718096;
                font-size: 18px;
                margin-bottom: 20px;
              }
              .badge {
                display: inline-block;
                background-color: #EE0000; /* Ansible Red */
                color: white;
                padding: 8px 16px;
                border-radius: 20px;
                font-weight: bold;
                margin-top: 15px;
              }
            </style>
          </head>
          <body>
            <div class="card">
              <h1>Welcome Eng. Omar Heggy</h1>
              <p class="subtitle">I am <strong>Bahi</strong></p>
              <div class="badge">Terraform + I am also using Ansible!</div>
            </div>
          </body>
          </html>